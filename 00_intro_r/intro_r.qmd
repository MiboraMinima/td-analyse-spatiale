# Introduction √† R et RStudio

Comme dans la majorit√© des langages interpr√©t√©s, quand on installe `R`, une
[console
interactive](https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop)
est install√©e en m√™me temps. Vous pouvez y acc√©der en cherchant R dans vos
programmes ou en effectuant les op√©rations `ctrl+R` (ouvrir l'ex√©cuteur de
commmande) > `R` > `enter`. C'est comme quand vous ouvrez un terminal
`powershell` sous Windows, sauf qu'au lieu d'√©crire du `powershell`, vous
√©crivez du `R`.

Dans l'absolu, on pourrait √©crire nos scripts dans la console directement mais
ce serait tr√®s peu pratique. Aussi, quand on code, on utilise un **Environnement
de D√©veloppement** (*IDE* en Anglais), et ce, quelque soit le langage que l'on
utilise. Ces derniers int√®grent des tas de fonctionnalit√©s pour vous simplifier
la vie (colorisation du code, diagnostique automatique des erreurs de syntaxe,
outils int√©gr√©s de visualisation, etc.). Il y en a beaucoup. Certains sont
g√©n√©riques (ils supportent de nombreux langages) comme [Visual Studio
Code](https://code.visualstudio.com/) ou sp√©cifique, destin√© √† un seul langage,
comme c'est le cas de [RStudio](https://posit.co/download/rstudio-desktop/) pour
`R`.

## RStudio

Il s'agit de l'IDE le plus utilis√© pour faire du `R`, et de tr√®s tr√®s loin. Il
est *open-source* et fr√©quemment mis √† jour.

### Cr√©ation d'un projet

#### Organiser son dossier de travail {#sec-orga-files}

La premi√®re chose √† faire quand on commence un projet, quelqu'il soit, c'est de
se **cr√©er un espace de travail coh√©rent** ou vous vous retrouverez facilement.
Ce dernier doit √™tre le plus g√©n√©ralisable possible, de telle sorte √† ce que
vous puissier le r√©employer pour d'autres projets. De cette fa√ßon, vous ne serez
plus jamais perdus dans vos fichiers et vous **gagnerez un temps consid√©rable**.
Pour de l'analyse/traitement de donn√©es, je vous conseil la configuration
suivante :

- üìÅ `./data/`: l√† o√π vous stockerez vos donn√©es
    - üìÅ `./data/src/`: Les donn√©es sources
    - üìÅ `./data/res/`: Les donn√©es cr√©√©es par vos scripts
- üìÅ `./docs/`: l√† o√π vous enregistrerez vos documents words par exemple.
- üìÅ `./figures/`: l√† o√π vous enregistrerez vos graphs, cartes, ect.
- üìÅ `./scripts/`: vos scripts R

Le `./` fait r√©f√©rence √† la **racine** du dossier : le chemin du dossier dans
lequel les dossiers ci-dessus sont enregistr√©s. Cette racine peut √™tre situ√©e o√π
vous le souhaitez sur votre machine.

:::{.callout-important title="Bien nommer ses fichiers"}

Pourquoi est-ce important ?

- Pour ne pas vous demander √† chaque fois pendant trois plombes √† comment vous
allez √©crire un nom de fichier ou de dossier.
- Encore une fois pour avoir une organisation nickel.
- Pour √©viter de vous retrouver avec des erreurs li√©s √† des espaces ou des
caract√®res sp√©ciaux.

Aussi, je vous conseil d'adopter une **convention d'√©criture**. Il y en a plein,
vous pouvez inventer la votre tant qu'elle est coh√©rente. Il est notamment
important de proscrire tous les signes diacritiques (√©, √®, √ß, √†, etc.), les
espaces et les signes (/, %, $, etc.). Je vous conseil la convention qui
consiste √† n'√©crire qu'en miniscule, sans caract√®res sp√©ciaux et en repla√ßant les
espaces par des underscores (`_`).

Par exemple :

:::::::::::::: {.columns}
::: {.column width="50%"}
**Bien**
```
td0_introduction_r.R
rendu_20250506_analyse_spatiale.R
graph_epervier.png
```
:::

::: {.column width="50%"}
**Naze**
```
TD 0 Introduction √† R .R
Rendu_2025/05/06_AnalyseSpatiale.R
Graphique √©pervier.png
```
:::
::::::::::::::
:::

#### Cr√©er un projet RStudio

Une fois que vous avez cr√©√© votre espace de travail dans votre explorateur de
fichier, proc√©dez aux op√©rations suivantes pour cr√©er un projet RStudio.

::: {.callout-tip title="Instructions"}
1. Ouvrez RStudio
2. Cr√©ez un nouveau projet: `Fichier` > `Nouveau projet` > `R√©pertoire existant`.
Indiquez le dossier que vous avez cr√©√© pr√©c√©demment.
3. Cr√©ez un nouveau script `R` : `Fichier` > `Nouveau fichier` > `Script R`.
   Enregistrez le (`ctrl+s`).
:::

### L'interface

![Interface de RStudio](figures/rstud_interface.png){#fig-rstud_inter}

L'interface fonctionne avec des panneaux que l'on peut changer au besoin dans
les pr√©f√©rences du logiciel[^0_rstud_panes]. Par d√©faut, on a l'organisation de la
@fig-rstud_inter.

[^0_rstud_panes]: `Affichage`>`Volet`>`Options de mise en page des volets`

- **A)**:
    - Dans ce panneau, vous avez vos scripts `R`. **C'est ici que vous
    √©crirez.**
- **B)**:
    - `Console`: La console `R`. La m√™me console int√©ractive que quand on ouvre
    `R` sans RStudio.
    - `Terminal`: Le terminal de votre machine. Sous Windows du `???`.
    - `Travaux`: Des *jobs* que vous faites tourner en arri√®re-plan.
- **C)**:
    - `Environnement`: La liste des objets de la session courante.
    - `Historique`: L'historique des commandes introduites dans la console `R`.
    - `Connexions`: Connexions √† des bases de donn√©es externes.
    - `Tutoriel`: tutos
- **D)**:
    - `Fichiers`: Un explorateur de fichier (comme l'explorateur de fichier windows)
    - `Graphiques`: Un espace o√π les graphs seront affich√©s.
    - `Paquets`: Liste de packages, vous pouvez les installer depuis cet
    onglet.
    - `Aide`: Onglet o√π sont affich√©s les documentations des fonctions que vous
    utilisez.
    - `Visualisateur`: Onglet d'affichage des graphs 3D, des pages webs, etc.
    - `Pr√©sentation`: Onglet d√©di√© aux pr√©sentations.

Il existe d'autres panneaux que l'on peut rajouter √† l'interface au besoin. Vous
aurez surtout besoin de la console, de l'environnement, de l'onglet graphique et
aide.

## Les bases de R pour le traitement de donn√©es

:::{.callout-tip title="Organiser son script R"}

Pour ne pas se perdre dans son code et garantir sa reproductibilit√©, il convient
de l'organiser soigneusement.

Un exemple typique de script en analyse de donn√©es et le suivant :

1. Chargement des packages. C'est toujours la premi√®re chose √† faire.
2. √âcriture des constantes (si n√©cessaire)
3. Chargement des donn√©es
4. Pr√©-traitement des donn√©es (nettoyage, merge, etc.)
5. L'analyse que l'on souhaite effectuer (le c≈ìur du script)
6. Analyse des r√©sultats (graphs, r√©sum√©s, etc.)

Pour bien se retrouver dans le script, on peut tirer parti des commentaires et
cr√©er des titres et des sous-titres. Par exemple :

```{r}
################################################################################
# Titre 1 ----
################################################################################
## Sous titre 1.1 --------------------------------------------------------------
# Commentaire classique

### Sous titre 1.1.1 -----------------------------------------------------------
# Commentaire classique

################################################################################
# Titre 2 ----
################################################################################
## Sous titre 2.1 --------------------------------------------------------------
# code etc.
```

Notez que RStudio identifie automatiquement les commentaires suivis d'un minimum
de quatre caract√®res similaire (`-` ou `#`) comme des niveaux de titre. Pour
d√©finir le niveau, il faut ajuster le nombre de `#` avant le titre (`#` h1, `##`
h2, etc.). Pour vous rendre d'une section √† une autre dans votre script, vous
pouvez utiliser le navigateur situ√© en bas √† gauche de l'onglet script.

:::

::: {.callout-note title="Instruction"}

Lisez l'introduction du @sec-structure-data.

:::

### Les variables

::: {.callout-note title="Instruction: variable"}

Lisez la @sec-variables.

1. Cr√©ez des variables de classe diff√©rentes
2. Essayez d'effectuer des op√©rations math√©matiques entre des variables de
   diff√©rentes classes. Qu'observez vous ?

:::

### Les vecteurs

::: {.callout-note title="Instructions: vecteurs"}

Lisez la @sec-vector.

**Vecteur num√©rique :**

1. Effectuer des op√©rations entre deux vecteurs num√©riques : que constatez vous
   ? Est-ce que vos op√©rations marchent avec des vecteurs de longueur diff√©rente ?
2. Effectuer des op√©rations entre une variable num√©rique et un vecteur num√©rique : que constatez vous ?
3. Calculer des statistiques √©l√©mentaires sur ces vecteurs (*cf.* @sec-stat-quanti).

**Vecteur de cha√Æne de caract√®res :** (aidez vous de la @sec-stat-quali)

```{r}
vector_str <- c("A", "a", "b", "b", "B", "C", "C")
```

1. Quels sont les modalit√©s du vecteur `vector_str` ?
2. Combien il y a t il de valeurs associ√©es √† chacune de ces modalit√©s ?

:::

### Les tableaux de donn√©es : les Data Frames


::: {.callout-note title="Instruction: cr√©ation de Data Frame"}

Lisez la @sec-structure-df.

Cr√©ez un DF de √† partir de quatre vecteurs de longueur 5 (2 num√©riques, 2 de
cha√Æne cararact√®res).

:::


::: {.callout-note title="Instructions: manipulation de Data Frame"}

Vous apprendrez avec un jeu de de donn√©es d'entra√Ænement issu du package
[`palmerpenguins`](https://allisonhorst.github.io/palmerpenguins/).

```{r}
data(package = 'palmerpenguins')
head(penguins)
```

Commencez par d√©crire bri√®vement le tableau de donn√©es :

- Nombre d'observations
- Nombre de variables (leur classe)

Pour les op√©rations suivantes, appuyez-vous sur la @sec-manip-df.

1. **S√©lection des variables : `select()`**

    1. S√©lectionner les variables `island` et `bill_len`.
    2. S√©lectionner uniquement les variables num√©riques
    3. S√©lectionner toutes les variables qualitatives sauf `island`

2. **Filtrer les observations : `filter()`**

    1. Ne conserver que les pingouins Ad√©lie de l'√Æle de Biscoe qui sont des m√¢les.
    2. Pour l'ann√©e 2007, ne conserver que les pingouins dont la masse est
       sup√©rieure √† la moyenne.
    3. Retirez les lignes contenant des valeurs manquantes.

3. **Cr√©er et modifier des variables : `mutate()`**

    1. Convertissez l'unit√© des nageoires '`flipper_len`' en cm.
    2. Cr√©er un indicateur correspondant √† la longueur du bec (`bill_len`) divis√©
       par sa profondeur (`bill_dep`).

4. **R√©sum√© de DF :** `summarise()/group_by()`

    1. Calculer la m√©diane et l'amplitude de `bill_len`.
    2. Calculer la m√©diane de chaque variable num√©rique.
    3. Calculer la m√©diane de la longueur du bec par esp√®ce
    3. Calculer la m√©diane de la longueur du bec par esp√®ce et par sexe.

5. **Jointure de donn√©es :** 

    1. Chargez les donn√©es : (*cf.* @sec-io-df)
        - Donn√©es g√©ographique : `iris_29.gpkg`
        - Donn√©es INSEE : `iris_brest.csv`
    2. Joignez la donn√©e spatiale aux donn√©es INSEE (*cf.* @sec-join).

:::


### R√©f√©rences

Cheat sheet :

- [RStudio](https://rstudio.github.io/cheatsheets/rstudio-ide.pdf){target="_blank"}
- [Base R](https://iqss.github.io/dss-workshops/R/Rintro/base-r-cheat-sheet.pdf){target="_blank"}
- [dplyr](https://thinkr.fr/pdf/dplyr-french-cheatsheet.pdf){target="_blank"}


